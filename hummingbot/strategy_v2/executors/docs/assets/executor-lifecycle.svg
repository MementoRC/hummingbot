stateDiagram-v2
    [*] --> Created: Factory Creates
    Created --> Running: Start
    Running --> Running: Control Loop
    Running --> ShuttingDown: Stop Action
    Running --> ShuttingDown: Early Stop
    Running --> ShuttingDown: Stop Loss Hit
    Running --> ShuttingDown: Take Profit Hit
    Running --> ShuttingDown: Time Limit
    ShuttingDown --> Terminated: Clean Shutdown
    ShuttingDown --> Failed: Max Retries
    Terminated --> [*]
    Failed --> [*]

    note right of Running
        - Monitors barriers
        - Controls orders
        - Updates state
    end note

    note right of ShuttingDown
        - Cancels open orders
        - Places close orders
        - Finalizes position
    end note
